#!/bin/sh

echo "üß™ Running UI tests after commit..."

# Next.js dev ÏÑúÎ≤Ñ Ìè¨Ìä∏ Ï∞æÍ∏∞ (3001 Ïö∞ÏÑ† - Next.jsÍ∞Ä 3000Ïù¥ ÏÇ¨Ïö©Ï§ëÏù¥Î©¥ 3001Î°ú Í∞ê)
if curl -s --max-time 2 http://localhost:3001 > /dev/null 2>&1; then
  PORT=3001
elif curl -s --max-time 2 http://localhost:3000 > /dev/null 2>&1; then
  PORT=3000
else
  PORT=""
fi

if [ -n "$PORT" ]; then
  echo "Using dev server on port $PORT"
  TEST_URL="http://localhost:$PORT" npx playwright test --reporter=line
else
  echo "No running server, starting one..."
  npx playwright test --reporter=line
fi

if [ $? -eq 0 ]; then
  echo "‚úÖ All tests passed!"
else
  echo "‚ùå Some tests failed. Check: npx playwright show-report"
fi
